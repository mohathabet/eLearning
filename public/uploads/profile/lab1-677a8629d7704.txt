# TP Sécurité des Réseaux – VLAN, Routage Inter-VLAN & ACL## **Objectifs :**- Créer et configurer des VLANs sur un switch.- Configurer le routage inter-VLAN sur un routeur.- Appliquer des ACL (Access Control Lists) pour contrôler le trafic.- Tester la connectivité entre différents postes dans un réseau segmenté.---## **1? Création et Configuration des VLANs**### **? Etape 1 : Connexion au switch**#### **Commandes :**```plaintextSwitch>enableSwitch#configure terminalSwitch(config)#hostname SW-ETAB-A```- **enable** : Passe du mode utilisateur au mode privilégié.- **configure terminal** : Accède au mode de configuration globale.- **hostname SW-ETAB-A** : Change le nom du switch en SW-ETAB-A.---### **? Etape 2 : Configuration de la console**#### **Commandes :**```plaintextSW-ETAB-A(config)#line console 0SW-ETAB-A(config-line)#logging synchronousSW-ETAB-A(config-line)#exit```- **line console 0** : Configure la console pour les connexions locales.- **logging synchronous** : Empêche les messages du switch d'interrompre la saisie des commandes.- **exit** : Retourne au mode de configuration globale.---### **? Etape 3 : Création des VLANs**#### **Création du VLAN 20 :**```plaintextSW-ETAB-A(config)#vlan 20SW-ETAB-A(config-vlan)#name adminSW-ETAB-A(config-vlan)#exit```- **vlan 20** : Crée un VLAN avec l'ID 20.- **name admin** : Attribue le nom "admin" au VLAN 20.#### **Création du VLAN 30 :**```plaintextSW-ETAB-A(config)#vlan 30SW-ETAB-A(config-vlan)#name ENSSW-ETAB-A(config-vlan)#exit```- **vlan 30** : Crée un VLAN avec l'ID 30.- **name ENS** : Attribue le nom "ENS" au VLAN 30.---### **? Etape 4 : Affectation des ports aux VLANs**#### **Pour le VLAN 20 :**```plaintextSW-ETAB-A(config)#interface gigabitEthernet 0/0SW-ETAB-A(config-if)#switchport mode accessSW-ETAB-A(config-if)#switchport access vlan 20SW-ETAB-A(config-if)#exitSW-ETAB-A(config)#interface gigabitEthernet 0/2SW-ETAB-A(config-if)#switchport mode accessSW-ETAB-A(config-if)#switchport access vlan 20SW-ETAB-A(config-if)#exit```- **switchport mode access** : Configure le port en mode access (liaison avec un seul VLAN).- **switchport access vlan 20** : Affecte le port au VLAN 20.#### **Pour le VLAN 30 :**```plaintextSW-ETAB-A(config)#interface gigabitEthernet 0/1SW-ETAB-A(config-if)#switchport mode accessSW-ETAB-A(config-if)#switchport access vlan 30SW-ETAB-A(config-if)#exitSW-ETAB-A(config)#interface gigabitEthernet 0/3SW-ETAB-A(config-if)#switchport mode accessSW-ETAB-A(config-if)#switchport access vlan 30SW-ETAB-A(config-if)#exit```---## **2? Configuration du Routage Inter-VLAN**Pour permettre la communication entre les VLANs, un routeur doit être configuré.### **? Etape 1 : Configuration du routeur**#### **Commandes :**```plaintextR1>enableR1#configure terminalR1(config)#hostname R-ETAB-A```- **enable** : Passe en mode privilégié.- **configure terminal** : Accède au mode de configuration.- **hostname R-ETAB-A** : Change le nom du routeur.### **? Etape 2 : Configuration des interfaces physiques**#### **Configuration pour le VLAN 20 :**```plaintextR-ETAB-A(config)#interface fastEthernet 0/0R-ETAB-A(config-if)#ip address 192.168.20.1 255.255.255.0R-ETAB-A(config-if)#no shutdown```- **interface fastEthernet 0/0** : Accède à l'interface FastEthernet 0/0.- **ip address 192.168.20.1 255.255.255.0** : Attribue une adresse IP à l'interface.- **no shutdown** : Active l'interface.#### **Configuration pour le VLAN 30 :**```plaintextR-ETAB-A(config)#interface fastEthernet 1/0R-ETAB-A(config-if)#ip address 192.168.30.1 255.255.255.0R-ETAB-A(config-if)#no shutdown```---## **3? Configuration des ACL (Access Control Lists)**Les ACL permettent de contrôler le trafic entrant ou sortant sur une interface.### **? ACL Standard (Bloquer tout sauf une IP spécifique)**#### **Commandes :**```plaintextR-ETAB-A(config)#access-list 1 permit 192.168.30.2 0.0.0.0R-ETAB-A(config)#interface fastEthernet 0/1.20R-ETAB-A(config-if)#ip access-group 1 out```- **access-list 1 permit** : Autorise une adresse IP spécifique.- **ip access-group 1 out** : Applique l'ACL sur l'interface.---### **exp**---## **4? Configuration du WAN des Établissements A & B**### **? Etape 1 : Configuration des interfaces WAN**#### **Sur le Routeur R-ETAB-A :**```plaintextR-ETAB-A(config)#interface fastEthernet 0/0R-ETAB-A(config-if)#ip address 172.168.12.1 255.255.255.0R-ETAB-A(config-if)#no shutdown```- **interface fastEthernet 0/0** : Accède à l'interface WAN.- **ip address 172.168.12.1 255.255.255.0** : Configure l'adresse IP WAN du routeur A.- **no shutdown** : Active l'interface.#### **Sur le Routeur R-ETAB-B :**```plaintextR-ETAB-B(config)#interface fastEthernet 0/0R-ETAB-B(config-if)#ip address 172.168.12.2 255.255.255.0R-ETAB-B(config-if)#no shutdown```- **interface fastEthernet 0/0** : Accède à l'interface WAN.- **ip address 172.168.12.2 255.255.255.0** : Configure l'adresse IP WAN du routeur B.- **no shutdown** : Active l'interface.---### **? Etape 2 : Tests de connectivité WAN entre les routeurs**#### **Commande :**```plaintextR-ETAB-A#ping 172.168.12.2```- **ping** : Teste la connectivité entre les deux routeurs.Si le ping est positif, la connexion WAN entre les deux routeurs est établie.---## **5? Configuration du Routage Statique**### **? Etape 1 : Configuration sur le Routeur R-ETAB-B**Pour joindre le réseau 192.168.20.0/24 via R-ETAB-A :```plaintextR-ETAB-B(config)#ip route 192.168.20.0 255.255.255.0 172.168.12.1```Pour joindre le réseau 192.168.30.0/24 via R-ETAB-A :```plaintextR-ETAB-B(config)#ip route 192.168.30.0 255.255.255.0 172.168.12.1```- **ip route** : Configure une route statique vers les réseaux connectés à R-ETAB-A.### **? Etape 2 : Configuration sur le Routeur R-ETAB-A**Pour joindre le réseau 10.10.20.0/24 via R-ETAB-B :```plaintextR-ETAB-A(config)#ip route 10.10.20.0 255.255.255.0 172.168.12.2```Pour joindre le réseau 10.10.30.0/24 via R-ETAB-B :```plaintextR-ETAB-A(config)#ip route 10.10.30.0 255.255.255.0 172.168.12.2```- **ip route** : Configure une route statique vers les réseaux connectés à R-ETAB-B.---## **Conclusion :**La configuration du WAN permet la communication entre les deux établissements via les routeurs. Le routage statique assure que chaque routeur sait comment atteindre les réseaux distants. Cette connexion est essentielle pour assurer la connectivité globale entre les deux sites.